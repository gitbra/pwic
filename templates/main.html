<!DOCTYPE html>
<html lang="{{pwic.constants.language|escape}}">
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="generator" content="Pwic version {{pwic.constants.version|escape}}">
	<meta charset="utf-8">
	<title>{{pwic.title|escape}} - Pwic</title>
	<link rel="stylesheet" type="text/css" href="/static/styles.css" />
	<link rel="stylesheet" type="text/css" href="/static/styles-print.css" media="print" />
	<link rel="icon" type="image/png" href="/static/favicon.png" />

	{% if pwic.env.css %}
		{% set list = pwic.env.css.value.split(';') %}
		{% for css in list %}
			<link rel="stylesheet" type="text/css" href="{{css|trim|urlencode}}" />
		{% endfor %}
	{% endif %}

	{% if pwic.env.no_printing %}
		<style media="print">
			BODY { display: none }
		</style>
	{% endif %}

	{% if pwic.project != 'special' and pwic.page != 'help' %}
		{% if pwic.env.mde %}
			<link rel="stylesheet" href="/static/easymde.min.css" />
			<script src="/static/easymde.min.js"></script>
		{% endif %}

		{% if pwic.env.mathjax %}
			<script>
				window.MathJax = {
					tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
					svg: { fontCache: 'global' }
				};
				(function () {
					var mathjax = document.createElement('script');
					mathjax.src = '/static/mathjax.min.js';
					mathjax.async = true;
					document.head.appendChild(mathjax);
				})();
			</script>
		{% endif %}
	{% endif %}

	<script>
		'use strict';

		function pwic_entities(value) {
			while (true)
			{
				var curlen = value.length;
				value = value.replace('<', '&lt;').replace('>', '&gt;').replace('"', '&quote');
				if (value.length == curlen)
					break;
			}
			return value;
		}

		function pwic_is_safe(name) {
			var chars = '{{pwic.constants.unsafe_chars|replace("\\", "\\\\")|replace("'", "\\'")}}';
			for (var i=0 ; i<chars.length ; i++)
				if (name.indexOf(chars[i]) !== -1)
					return false;
			return true;
		}

		function pwic_kick(value, chars) {
			while (true)
			{
				var curlen = value.length;
				for (var i=0 ; i<chars.length ; i++)
					value = value.replace(chars[i], '');
				if (value.length == curlen)
					break;
			}
			return value;
		}

		function pwic_slash(value) {
			// https://stackoverflow.com/questions/18251399/why-doesnt-encodeuricomponent-encode-single-quotes-apostrophes
			return value.split("'").join("\\'").split('"').join('\\"');
		}

		function pwic_toggle(id) {
			document.getElementById(id).classList.toggle('pwic_hidden');
			return false;
		}

		function pwic_url_status(success, failed) {
			if (window.location.toString().indexOf('?success') !== -1)
				alert(success);
			else
				if (window.location.toString().indexOf('?failed') !== -1)
					alert(failed);
		}
	</script>
</head>
<body id="top">
	{% block content%}{% endblock %}
	{% block footer%}{% endblock %}
</body>
</html>